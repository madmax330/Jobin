{% extends 'home/base.html' %}

{% block title %}User Registration{% endblock %}

{% block content %}

    <div class="container">
        <div class="panel panel-default primary-panel">
            <div class="panel-heading">
                <h3>New {{ type }} registration:</h3>
            </div>
            <div class="panel-body">
                <form id="register-form" action="{% url 'home:register' ut=type %}" method="post"
                      enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="form-error {% if not error %}hidden{% endif %} alert alert-danger">
                        {{ error }}
                    </div>
                    <div class="form-group">
                        <label class="required">Email:</label>
                        <input id="email" placeholder="{% if type == 'student' %}University Email Address{% else %}Email{% endif %}"
                               name="email" class="form-control" type="email"/>
                    </div>
                    <div class="form-group">
                        <label class="required">Confirm Email:</label>
                        <input id="confirm_email" placeholder="Confirm Email"
                               name="confirm_email" class="form-control" type="email"/>
                    </div>
                    <div class="form-group">
                        <label class="required">Password:</label>
                        <input id="password" placeholder="Password"
                               name="password" class="form-control" type="password"/>
                    </div>
                    <div class="form-group">
                        <label class="required">Confirm Password:</label>
                        <input id="confirm_password" placeholder="Confirm Password"
                               name="confirm_password" class="form-control" type="password"/>
                    </div>
                    <div class="form-group">
                        <div class="hidden must-agree alert alert-danger">
                            You must agree to the Terms and Conditions and Privacy Policy to continue.
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" value="" id="tcpp-checkbox">
                                I agree to the
                                <a target="_blank" href="{% url 'home:terms' %}">Terms and Conditions</a>
                                and
                                <a target="_blank" href="{% url 'home:policy' %}">Privacy Policy</a>.
                            </label>
                        </div>
                    </div>
                    <div>
                        <a href="{% url 'home:index' %}" class="btn btn-default">Cancel</a>
                        <button class="btn btn-primary" type="submit">Sign Up</button>
                    </div>
                </form>
            </div>
            <div class="panel-footer">
                <p>
                    Once you signup you will be sent an email where
                    you can verify your account to activate it.
                    {% if type == 'student' %}
                        <br/>
                        <strong>Make sure you use your school email.</strong>
                    {% endif %}
                </p>
            </div>
        </div>
    </div>


    <script>
        function show(el) {
            if(el.hasClass('hidden')){
                el.removeClass('hidden');
            }
        }

        $(function () {
            $('#email')[0].maxLength = 100;

            $('#register-form').submit(function () {
                let email = $('#email').val();
                let c_email = $('#confirm_email').val();
                if (email !== c_email) {
                    show($('.no-email-match'));
                    return false;
                }
                let pass = $('#password').val();
                let c_pass = $('#confirm_password').val();
                if (pass !== c_pass) {
                    show($('.no-pass-match'));
                    return false;
                }
                let check = $('#tcpp-checkbox');
                if(!(check.is(':checked') && check.prop('checked'))){
                    show($('.must-agree'));
                    return false;
                }
            });
        });
    </script>
{% endblock %}