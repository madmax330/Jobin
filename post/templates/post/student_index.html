{% extends 'student/base.html' %}

{% block title %}Post List{% endblock %}

{% load staticfiles %}
{% block styles %}
    <link rel="stylesheet" href="{% static 'post/post.css' %}">
{% endblock %}
{% block scripts %}
    <script type="text/javascript" src="{% static 'post/student_post_util.js' %}"></script>
    <script>
        $(function() {
            hide($('.post-loader-icon'));
            show($('.main-post-container'));
        });
    </script>
{% endblock %}

{% block content %}
    {% if not resumes %}
        <div>
            <div class="w3-container w3-padding message-warning w3-display-container">
                <p>
                    You have not yet created a resume and won't be able to apply. Go to the "Resumes" section
                    and create a new resume to get started.
                </p>
            </div>
        </div>
    {% endif %}
    <div class="job-nav">
        <div class="w3-container secondary-color" style="padding-bottom: 0;">
            <h3 class="w3-center">({{ count }}) {{ d_category }} Job Posts</h3>
        </div>
        <div class="w3-cell-row primary-color w3-text-white job-navbar">
            <div class="w3-cell">
                <a href="{% url 'post:student_posts' cat='volunteer' pk=0 %}"
                   class="w3-btn w3-hover-white w3-block w3-padding page-link">
                    ({{ volunteer_count }}) Volunteer
                </a>
            </div>
            <div class="w3-cell">
                <a href="{% url 'post:student_posts' cat='internship' pk=0 %}"
                   class="w3-btn w3-hover-white w3-block w3-padding page-link">
                    ({{ internship_count }}) Internships
                </a>
            </div>
            <div class="w3-cell">
                <a href="{% url 'post:student_posts' cat='part_time' pk=0 %}"
                   class="w3-btn w3-hover-white w3-block w3-padding page-link">
                    ({{ part_time_count }}) Part-Time
                </a>
            </div>
            <div class="w3-cell">
                <a href="{% url 'post:student_posts' cat='startup' pk=0 %}"
                   class="w3-btn w3-hover-white w3-block w3-padding page-link">
                    ({{ startup_count }}) Start Up
                </a>
            </div>
            <div class="w3-cell">
                <a href="{% url 'post:student_posts' cat='full_time' pk=0 %}"
                   class="w3-btn w3-hover-white w3-block w3-padding page-link">
                    ({{ full_time_count }}) Full Time
                </a>
            </div>
        </div>
        <form id="post-filter-form" class="form-inline">
            <div class="w3-cell-row w3-container w3-padding secondary-color job-filters">
                <div class="w3-cell">
                    <label for="location_filter">Location:</label>
                    <input id="location_filter" name="location_filter" placeholder="City or State/Province..."
                           type="text" value="{{ filters.location }}">
                </div>
                <div class="w3-cell">
                    <label for="keyword_filter">Keyword:</label>
                    <input id="keyword_filter" name="keyword_filter" placeholder="Job Title..."
                           type="text" value="{{ filters.keyword }}">
                </div>
                <div class="w3-cell">
                    <a href="{% url 'post:student_posts' cat=category pk='0' %}"
                       class="w3-btn w3-border w3-border-black filter-btn">Clear</a>
                    <button class="w3-btn w3-border w3-border-black filter-btn">Filter</button>
                </div>
            </div>
        </form>
        <div class="post-loader-icon">
            <h2 class="w3-center"><i class="fa fa-spinner fa-spin"></i> Loading job posts...</h2>
        </div>
        <div class="w3-content w3-container w3-padding-16 main-post-container w3-hide" style="position:relative">
            {% if posts %}
                {% for x in posts %}
                    <div class="w3-display-container mySlides w3-animate-right  w3-white"
                         style="margin: 0 40px 0 40px;">
                        <div class="row">
                            <div class="w3-col s4">
                                <div class="w3-container w3-padding secondary-color">
                                    <h4>Company</h4>
                                </div>
                                <div class="w3-container">
                                    {% if x.logo %}
                                        <div class="logo-container">
                                            <img src="{{ x.logo.url }}">
                                        </div>
                                    {% endif %}
                                    <h5>{{ x.name }}</h5>
                                    <label>Address:</label><span> {{ x.address }}</span><br/>
                                    <label>Website:</label><a target="_blank"
                                                              href="http://{{ x.website }}"> {{ x.website }}</a>
                                </div>
                                <div class="w3-container secondary-color resumes-section">
                                    <h5>Resumes</h5>
                                </div>
                                <table class="w3-table w3-bordered">
                                    {% for y in resumes %}
                                        <tr>
                                            {% if y.is_active %}
                                                <td>
                                                    <strong>{{ y.name }}</strong>
                                                </td>
                                            {% else %}
                                                <td>
                                                    <a href="#" class="change-resume"
                                                       data-url="{% url 'resume:activate' pk=y.id %}">
                                                        {{ y.name }}
                                                    </a>
                                                </td>
                                            {% endif %}
                                        </tr>
                                    {% endfor %}
                                </table>
                            </div>
                            <div class="w3-col s8">
                                <div class="w3-container w3-padding secondary-color">
                                    <h4>Post Information</h4>
                                </div>
                                <div class="slide-container w3-container scrollable">
                                    <h5>{{ x.title }}</h5>
                                    <label>Start Date:</label><span> {{ x.start_date }}</span><br/>
                                    <label>End Date:</label><span> {{ x.end_date }}</span><br/>
                                    <label>Wage:</label>
                                    {% if x.wage and x.wage > 0 %}
                                        <span> {{ x.wage }}$/{{ x.wage_interval }}</span>
                                    {% else %}
                                        <span> N/A</span>
                                    {% endif %}
                                    <br/>
                                    <label>Number of positions:</label><span> {{ x.openings }}</span><br/>
                                    <label>
                                        <strong>Application Deadline:</strong>
                                    </label><span> {{ x.deadline }}</span><br/>
                                    <label><strong>Requirements:</strong></label><br/>
                                    <span>{{ x.requirements | linebreaksbr }}</span><br/>
                                    <label><strong>Description:</strong></label><br/>
                                    <span>{{ x.description | linebreaksbr }}</span>
                                    <div class="w3-hide increment-url">{% url 'post:increment' pk=x.id %}</div>
                                    <div class="w3-hide post-url">{% url 'post:student_posts' cat=category pk=x.id %}</div>
                                </div>
                            </div>
                        </div>
                        <div class="w3-display-topright w3-medium w3-container w3-padding-16 apply-btn">
                            {% if not x.applied %}
                                <button class="w3-btn apply w3-text-black w3-border w3-border-black"
                                        data-url="{% url 'post:apply' pk=x.id %}">
                                    Apply for this post
                                </button>
                            {% else %}
                                <button class="w3-btn w3-text-black w3-border w3-border-black" disabled>
                                    Already applied.
                                </button>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="w3-display-container mySlides w3-white" style="margin: 0 40px 0 40px;">
                    <div class="w3-card-16" style="padding: 100px;">
                        <h3 class="w3-center">
                            There are currently no {{ d_category }} opportunities listed.
                        </h3>
                        <h4 class="w3-center">
                            Check back again later.
                        </h4>
                    </div>
                </div>
            {% endif %}
            <a class="w3-btn w3-display-left left-arrow" style="position:absolute;top:290px;left:0"
               onclick="plusDivs(-1)">❮</a>
            <a class="w3-btn w3-display-right right-arrow" style="position:absolute;top:290px;right:0"
               onclick="plusDivs(1)">❯</a>
        </div>
    </div>

{% endblock %}

{% block hidden_block %}
{% endblock %}

{% block walkthroughs %}
    {% include 'student/walkthrough/posts.html' %}
{% endblock %}

{% block page_name %}posts{% endblock %}
