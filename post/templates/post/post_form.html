{% extends 'company/base.html' %}

{% block title %}Post Information Form{% endblock %}

{% block page_body_class %}posts new-post{% endblock %}

{% block page_title_div %}
    <div class="pagetitle posts">
        <h1>New Post</h1>
    </div>
{% endblock %}

{% load staticfiles %}

{% block scripts %}
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script type="text/javascript" src="{% static 'home/scripts/form_util.js' %}"></script>
    <script type="text/javascript" src="{% static 'home/scripts/form_programs_majors_script.js' %}"></script>
{% endblock %}

{% block content %}
    <div class="panel panel-default primary-panel">
        <div class="panel-heading">
            <h4>Post Information Form</h4>
        </div>
        <div class="panel-body">
            <form id="post-form" method="post"
                  action="">
                {% csrf_token %}

                <div class="form-group has-error">
                    <label class="required" for="post_title">Title:</label>
                    {% if errors.title %}
                        <div class="alert alert-danger">
                            {{ errors.title }}
                        </div>
                    {% endif %}
                    <div class="alert form-error">
                            Post Title cannot be left blank.
                        </div>
                    <input id="post_title" class="form-control" type="text" name="post_title"
                           value="{{ post.title }}">
                </div>
                <div class="form-group">
                    <label for="post_programs">Programs:</label>
                    {% if errors.programs %}
                        <div class="alert alert-danger">
                            {{ errors.programs }}
                        </div>
                    {% endif %}
                    <select id="post_programs" class="form-control program-input" name="post_programs">
                        {% if post.programs %}
                            <option value="{{ post.programs }}">{{ post.programs }}</option>
                        {% endif %}
                    </select>
                </div>
                <div class="form-group">
                    <label class="required" for="post_type">Type:</label>
                    {% if errors.type %}
                        <div class="alert alert-danger">
                            {{ errors.type }}
                        </div>
                    {% endif %}
                    <select id="post_type" class="form-control" name="post_type">
                        <option value="internship">Internship</option>
                        <option value="full_time">Full Time</option>
                        <option value="part_time">Part Time</option>
                        <option value="volunteer">Volunteer</option>
                    </select>
                </div>
                <div class="form-group has-error">
                    <label for="post_wage">Wage:</label>
                    {% if errors.wage %}
                        <div class="alert alert-danger">
                            {{ errors.wage }}
                        </div>
                    {% endif %}
                    <div class="alert form-error">
                            Post Wage cannot be left blank.
                        </div>
                    <input id="post_wage" class="form-control" type="text" name="post_wage"
                           value="{% if post.wage %}{{ post.wage }}{% endif %}">
                </div>
                <div class="form-group">
                    <label class="radio-inline">
                        <input type="radio" name="post_wage_interval"
                               {% if post.wage_interval == 'hr' or not post %}checked="checked"{% endif %}
                                value="hr">
                        Hourly
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="post_wage_interval"
                               {% if post.wage_interval == 'mth' %}checked="checked"{% endif %}
                                value="mth">
                        Monthly
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="post_wage_interval"
                               {% if post.wage_interval == 'yr' %}checked="checked"{% endif %}
                                value="yr">
                        Yearly
                    </label>
                </div>
                <div class="form-group">
                    <label class="required" for="post_openings">Number of positions:</label>
                    {% if errors.openings %}
                        <div class="alert alert-danger">
                            {{ errors.openings }}
                        </div>
                    {% endif %}
                    <input id="post_openings" class="form-control" type="number" name="post_openings"
                           value="{{ post.openings }}">
                </div>
                <div class="form-group">
                    <label class="required" for="post_start">Start Date:</label>
                    {% if errors.start_date %}
                        <div class="alert alert-danger">
                            {{ errors.start_date }}
                        </div>
                    {% endif %}
                    <input id="post_start" class="form-control date-input" data-date="{{ post.start_date }}"
                           type="date" name="post_start" value="">
                </div>
                <div class="form-group">
                    <label for="post_end">End Date:</label>
                    {% if errors.end_date %}
                        <div class="alert alert-danger">
                            {{ errors.end_date }}
                        </div>
                    {% endif %}
                    <input id="post_end" class="form-control date-input" type="date" name="post_end"
                            value="" data-date="{{ post.end_date }}">
                </div>
                <div class="form-group">
                    <label class="required" for="post_deadline">Application Deadline:</label>
                    {% if errors.deadline %}
                        <div class="alert alert-danger">
                            {{ errors.deadline }}
                        </div>
                    {% endif %}
                    <input id="post_deadline" class="form-control date-input" type="date"
                           name="post_deadline" value="" data-date="{{ post.deadline }}">
                </div>
                <div class="form-group">
                    <label class="required" for="post_description">Description:</label>
                    {% if errors.description %}
                        <div class="alert alert-danger">
                            {{ errors.description }}
                        </div>
                    {% endif %}
                    <textarea id="post_description" name="post_description" class="form-control"
                              rows="5">{{ post.description }}</textarea>
                </div>
                <div class="form-group">
                    <label class="required" for="post_requirements">Requirements:</label>
                    {% if errors.requirements %}
                        <div class="alert alert-danger">
                            {{ errors.requirements }}
                        </div>
                    {% endif %}
                    <textarea id="post_requirements" name="post_requirements" class="form-control"
                              rows="5">{{ post.requirements }}</textarea>
                </div>
                <div class="form-group">
                    <label for="post_instructions">Cover letter instructions:</label>
                    {% if errors.cover_instructions %}
                        <div class="alert alert-danger">
                            {{ errors.cover_instructions }}
                        </div>
                    {% endif %}
                    <textarea id="post_instructions" name="post_cover" class="form-control"
                              rows="5">{% if post.cover_instructions %}{{ post.cover_instructions }}{% endif %}</textarea>
                </div>
                <div>
                    <a href="{% url 'post:company_posts' %}" class="btn btn-default">Cancel</a>
                    <button class="btn btn-success" type="submit">Submit</button>
                </div>
            </form>
        </div>
    </div>
    <script>
        $(function() {
            let select = $('select#post_type');
            let t = $('.post-type').text();
            if(t){
                select.val(t);
            }

            select.on('change', function(){
                let val = $(this).find('option:selected').val();
                if(val === 'volunteer'){
                    $('#post_wage').val('0');
                }
                else{
                    $('#post_wage').val('');
                }
            });
        });
    </script>
{% endblock %}

{% block hidden_block %}
    {% include 'home/utils/form_values.html' %}
    <div class="post-type">{% if post.type %}{{ post.type }}{% endif %}</div>
{% endblock %}
