{% extends 'student/student_base.html' %}

{% block title %}Student Home{% endblock %}

{% block homeactive %}active{% endblock %}

{% block scripts %}
    {% load staticfiles %}
    <script src="{% static 'home/page_script.js' %}"></script>
{% endblock %}

{% block content %}
    <div class="w3-row">
        <div class="w3-col s12 m12 l12">
            {% if old_apps.count > 0 %}
                <div class="w3-container">
                    <div class="message info-message">
                        <h4>Application Renewal:</h4>
                        {% for x in old_apps %}
                            <hr/>
                            The post <strong>{{ x.post_title }}</strong> has been re-opened, since you showed interest
                            in this post on {{ x.date }} your application was automatically forwarded. <br/>
                            <a href="{% url 'post:recover_old_app' ak=x.pk %}">
                                <strong>Click Here</strong>
                            </a> to keep the application active. <br/>
                            or <br/>
                            <a href="{% url 'post:remove_old_app' ak=x.pk %}">
                                <strong>Click Here</strong>
                            </a> to close the application. <br/>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
            <div class="w3-container">
                <h4 style="margin:0;" class="title-color w3-center w3-padding-8 w3-text-white">Active Applications</h4>
                {% if apps.count == 0 %}
                    <div class="warning-message message">
                        You currently have no active applications. <a href="{% url 'post:studentposts' pk=0 pt='internship'%}">Browse the posts</a> to apply.
                    </div>
                {% else %}
                    <table class="w3-table w3-bordered w3-white">
                        <tr>
                            <th>Post Title</th>
                            <th>Resume</th>
                            <th>Status</th>
                            <th></th>
                        </tr>
                        {% for x in apps %}
                            <tr {% if x.cover_requested %}class="w3-border-green w3-pale-green"{% endif %}>
                                <td><a href="{% url 'post:studentdetails' pk=x.post.pk ak=x.pk%}">{{ x.post_title }}</a></td>
                                <td>
                                    <div class="w3-dropdown-hover">
                                        <a href="#">{{ x.resume.name }}</a>
                                        <div class="w3-dropdown-content w3-border">
                                            {% for r in resumes %}
                                                <a href="#" class="warning-open">{{ r.name }}</a>
                                                <div class="warning hide">
                                                    <h4>Change resume for {{ x.post_title }} to {{ r.name }}?</h4>
                                                    <hr/>
                                                    <p>This will change the resume {{ x.resume.name }} with {{ r.name }}.
                                                    <br/>
                                                    (<strong>Note:</strong> a notification will be sent to {{ x.post.company }} to alert that you have
                                                    updated your resume.)</p>
                                                    <button class="warning-close w3-btn regular-btn" type="button">Cancel</button>
                                                    <a class="w3-btn regular-btn" href="{% url 'resume:change' rk=r.pk ak=x.pk %}">Change Resume</a>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>

                                </td>
                                <td>{{ x.status }}</td>
                                <td>
                                    <a href="#" class="warning-open">Withdraw</a>
                                    <div class="warning hide">
                                        <h4>Are you sure you want to withdraw your application for the
                                            <u>{{ x.post_title }}</u> position?</h4>
                                        <hr/>
                                        <p>This will permanently remove your application from consideration for this
                                         post.</p>
                                        <button class="warning-close w3-btn regular-btn" type="button">Cancel</button>
                                        <a class="w3-btn danger-btn"
                                           href="{% url 'post:remove_old_app' ak=x.pk %}">Withdraw</a>
                                    </div>
                                </td>
                            </tr>
                        {% endfor %}
                        <tr>
                            <td colspan="4">
                                <span>Page: </span><span class="hide page-object">app_page</span>
                                {% for x in apages %}
                                    {% if x == apage %}
                                        <strong><span>{{ x }} </span></strong>
                                    {% else %}
                                        <span class="app-page-number page-number">{{ x }} </span>
                                    {% endif %}|
                                {% endfor %}
                            </td>
                        </tr>
                    </table>
                {% endif %}
            </div>
            <div class="w3-container w3-padding-16">
                <h4 style="margin:0;" class="title-color w3-center w3-padding-8 w3-text-white">Interested Events</h4>
                {% if events.count == 0 %}
                    <div class="warning-message message">
                        You currently have shown no interest in any events. <a href="{% url 'event:studentevents' pk=0 %}">Browse the events</a> to see which ones interest you.
                    </div>
                {% else %}
                    <table class="w3-table w3-bordered w3-white">
                        <tr>
                            <th>Title</th>
                            <th>Date & Time</th>
                            <th>Address</th>
                        </tr>
                        {% for x in events %}
                            <tr {% if x.cover_requested %}class="w3-border-green w3-pale-green"{% endif %}>
                                <td><a href="{% url 'event:studentevents' pk=x.event.pk %}">{{ x.event.title }}</a></td>
                                <td>{{ x.event.date }} at {{ x.event.time }}</td>
                                <td>{{ x.event.address }}, {{ x.event.city }}, {{ x.event.state }}</td>
                            </tr>
                        {% endfor %}
                        <tr>
                            <td colspan="4">
                                <span>Page: </span><span class="hide page-object">event_page</span>
                                {% for x in epages %}
                                    {% if x == epage %}
                                        <strong><span>{{ x }} </span></strong>
                                    {% else %}
                                        <span class="app-page-number page-number">{{ x }} </span>
                                    {% endif %}|
                                {% endfor %}
                            </td>
                        </tr>
                    </table>
                {% endif %}
            </div>
            <div class="hide">
                <form id="page-form" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input id="app_page" type="number" name="app_page" value="{{ apage }}"/>
                    <input id="event_page" type="number" name="event_page" value="{{ epage }}"/>
                </form>
                <div id="page-ids">app_page,event_page</div>
                <div id="current-app_page">{{ apage }}</div>
                <div id="current-event_page">{{ epage }}</div>
                <div id="form-id">page-form</div>
            </div>
        </div>
    </div>
{% endblock %}

{% block page_name %}home{% endblock %}

